#!/bin/env ruby
# encoding: utf-8
class String

  HEXRTF = ['\\\'e9', '\\\'f6', '\\\'f3', '\\\'ea', '\\\'e5', '\\\'ed', '\\\'e3', '\\\'f8', '\\\'f9', '\\\'e7', '\\\'f5',
            '\\\'fa', '\\\'f4', '\\\'fb', '\\\'e2', '\\\'e0', '\\\'ef', '\\\'f0', '\\\'ee', '\\\'eb', '\\\'e4', '\\\'e6',
            '\\\'fd', '\\\'ff', '\\\'f7', '\\\'f1', '\\\'ec', '\\\'e8', '\\\'f2', '\\\'fc', '\\\'e1', '\\\'fe', '\\\'c9',
            '\\\'d6', '\\\'d3', '\\\'ca', '\\\'c5', '\\\'cd', '\\\'c3', '\\\'d8', '\\\'d9', '\\\'c7', '\\\'d5', '\\\'da',
            '\\\'d4', '\\\'db', '\\\'c2', '\\\'c0', '\\\'cf', '\\\'d0', '\\\'ce', '\\\'cb', '\\\'c4', '\\\'c6', '\\\'dd',
            '\\\'df', '\\\'d7', '\\\'d1', '\\\'cc', '\\\'c8', '\\\'d2', '\\\'dc', '\\\'c1', '\\\'de', '\\\'b9', '\\\'b8',
            '\\\'a8', '\\par']
  RUWORD = ['й', 'ц', 'у', 'к', 'е', 'н', 'г', 'ш', 'щ', 'з', 'х',
            'ъ', 'ф', 'ы', 'в', 'а', 'п', 'р', 'о', 'л', 'д', 'ж',
            'э', 'я', 'ч', 'с', 'м', 'и', 'т', 'ь', 'б', 'ю', 'Й',
            'Ц', 'У', 'К', 'Е', 'Н', 'Г', 'Ш', 'Щ', 'З', 'Х', 'Ъ',
            'Ф', 'Ы', 'В', 'А', 'П', 'Р', 'О', 'Л', 'Д', 'Ж', 'Э',
            'Я', 'Ч', 'С', 'М', 'И', 'Т', 'Ь', 'Б', 'Ю', '№', 'ё',
            'Ё', '\n']

  def recode_for_rtf
    self.gsub(/[а-яА-ЯёЁ№]/) { |i| HEXRTF[RUWORD.index(i)] }
  end
end